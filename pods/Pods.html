<!DOCTYPE html>
<!-- saved from url=(0076)https://cloud-native-labs.s3.ap-south-1.amazonaws.com/dancing-hippo/03.html# -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Pods</title>
  <script src="./Pods_files/clipboard.min.js"></script>
  <script src="./Pods_files/jquery-3.5.1.min.js"></script>
  <script src="./Pods_files/clipboard.min.js"></script>
  <script src="./Pods_files/velocity.min.js"></script>
  <link rel="stylesheet" href="./Pods_files/font-awesome.min.css">
<style>
/* Based on Flatly from Bootswatch (https://bootswatch.com/flatly/) */
@import url("//fonts.googleapis.com/css?family=Lato:400,700,400italic");

/* document body (contains all content) */
body {
  font-family: "Lato", "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 15px;
  line-height: 1.42857143;
  color: #2c3e50;
  background-color: #ffffff;
  margin-left: 10%;
  margin-right: 10%;
}

/* document header (contains title etc) */
#header {
  width: 100%;
}
#header>h1 {
  border-bottom: 1px solid #ddddd8;
  padding-bottom: 8px;
}

/* headings */
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Lato", "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-weight: 400;
  line-height: 1.1;
  color: inherit;
}
h1,
h2,
h3 {
  margin-top: 21px;
  margin-bottom: 10.5px;
}
h4,
h5,
h6 {
  margin-top: 10.5px;
  margin-bottom: 10.5px;
}
h1 {
  font-size: 3em; 
/*   font-size: 39px;  */
}
h2 {
  font-size: 32px;
}
h3 {
  font-size: 26px;
}
h4 {
  font-size: 19px;
}
h5 {
  font-size: 15px;
}
h6 {
  font-size: 13px;
}

/* plain paragraph text */
.paragraph {
/*   font-family: sans-serif; */
  margin: 0 0 10.5px;
}
p {
/*   font-family: sans-serif; */
  margin: 0 0 10.5px;
}

/* blockquote text */
.quoteblock {
  font-style: italic;
}
blockquote {
  padding: 10.5px 21px;
  margin: 0 0 21px;
  font-size: 18.75px;
  border-left: 5px solid #ecf0f1;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #ecf0f1;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}

/* blockquote attribution text */
.attribution,
.cite,
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #b4bcc2;
}
.attribution:before,
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}

/* unordered list */
ul, ol {
  margin-top: 0;
  margin-bottom: 10.5px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}


/* links */
a {
  color: #18bc9c;
  background-color: transparent;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #18bc9c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}

/* horizontal rules */
hr {
  margin-top: 21px;
  margin-bottom: 21px;
  border: 0;
  border-top: 1px solid #ecf0f1;
}

/* table */
table {
  background-color: transparent;
  width: 100%;
  max-width: 100%;
  margin-bottom: 21px;
  border-collapse: collapse;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}

/* table caption */
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #b4bcc2;
  text-align: left;
}

/* table header row */
thead {
  border-bottom: 2px solid #ecf0f1;
}

/* table header cell */
th {
  text-align: left;
  padding-left: 8px;
}

/* table footer */
tfoot {
  color: #807F81;
  border-top: 1px solid #ecf0f1;
}

/* table cell */
td {
  border-top: 1px solid #ecf0f1;
}
td p {
  margin: auto;
  padding: 8px;
}

/* table body */
tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
tbody > tr:hover {
  background-color: #ecf0f1;
}

/* inline code */
code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 4px;  
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #ffffff;
  background-color: #333333;
  border-radius: 0;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
          box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  -webkit-box-shadow: none;
          box-shadow: none;
}
pre {
  display: block;
  padding: 10.5px;
  margin: 0 0 10.5px;
  font-size: 15px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #cccccc;
  border-radius: 4px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}

/* image */
img {
  max-width: 100%;
  vertical-align: middle;
}

/* footer section */
#footer {
  margin-top: 22px;
  padding: 14px 16px;
  color: white;
  background-color: #2c3e50;
}

/* responsiveness fixes */
video {
  max-width: 100%;
}

/* table of Contents sidebar */
#toctitle {
  color: #ffffff;
}

#toc ul {
  display: inline;
  list-style-type: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

#toc li {
  display: block;
}

#toc a {
  background-color: #2c3e50;
  float: left;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

#toc li a:hover {
  background-color: #1a242f;
  text-decoration: none;
}

#toc:after {
  content: " ";
  visibility: hidden;
  display: block;
  height: 0;
  clear: both;
}

@media all and (max-width: 600px) {
table {
  width: 55vw!important;
  font-size: 3vw;
}

</style>
<link rel="stylesheet" href="./Pods_files/font-awesome.min(1).css">
</head>
<body class="article">
<div id="header">
<h1>Pods</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This lab consists of a list of exercises to demonstrate and understand
the most commonly used kubernetes commands and concepts to ramp up your kubernetes competency skills in the area of <code>Pods</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_learning_outcomes">Learning Outcomes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After completing the lab, you will be able to understand and use Kubernetes concepts based on use-case scenarios in the following domains:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Advanced Configuration &amp; Custom Commands</p>
</li>
<li>
<p>Environment Variables</p>
</li>
<li>
<p>Probes and Observability</p>
</li>
<li>
<p>Volumes</p>
</li>
<li>
<p>SecurityContexts</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_start_the_minikube">Start the minikube</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start minikube locally
<code>minikube start --driver=virtualbox</code></p>
</li>
<li>
<p>Verify the kubectl context <code>kubectl config get-contexts</code> is set to minikube. If not, set it to minikube <code>kubectl config use-context minikube</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_setup_the_working_directory">Setup the working directory</h3>
<div class="ulist">
<ul>
<li>
<p>Create all manifest resources in the directory <code>~/workspace/kubernetes-manifests/competencies</code>. Watch out for the right file names in the solution section.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">mkdir -p ~/workspace/kubernetes-manifests/competencies
cd ~/workspace/kubernetes-manifests</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_configuration_custom_commands">Advanced Configuration &amp; Custom Commands</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the directory <code>pods</code> inside <code>competencies</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">mkdir ~/workspace/kubernetes-manifests/competencies/pods</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</li>
<li>
<p>Create a busybox pod which prints "Hello from pages Yellow Pages" on the console using manifest file.</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/1.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","echo Hello from pages Yellow Pages"]</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/1.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl logs busybox -f</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Create a busybox pod which prints "Hello from pages Yellow Pages" on the console, for every 10 seconds infinitely using manifest file.</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/2.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","while true;do echo 'Hello from pages Yellow Pages';sleep 10;done"]</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/2.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl logs busybox -f</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Create an nginx pod and test it in the browser</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/3.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: nginx</span></span>
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
    <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/3.yaml

kubectl port-forward pod/nginx 8080:80</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="textmate">curl localhost:8080   OR
localhost:8080 {from the browser}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po nginx</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Create a busybox pod which prints "Hello from pages Yellow Pages" on the console imperatively</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl run busybox --image=busybox --image-pull-policy=IfNotPresent  sh -- -c 'echo "Hello from pages Yellow Pages"'</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl logs busybox -f</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Create a busybox pod which prints <code>current date</code> on the console, for every 10 seconds infinitely</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/7.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","while true;do date;sleep 10;done"]</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/7.yaml

kubectl get po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl logs busybox -f</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_environment_variables">Environment variables:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create environment variables for busybox pod with key=<code>course</code> and value=<code>K8s</code> and also prints "Hello!" on the console, for every 10 seconds infinitely using manifest file.
Verify the environment variables are set properly</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/8.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","while true;do echo 'Hello!';sleep 10;done"]</span></span>
      <span style="color:#606">env</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: course</span></span>
          <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8s</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/8.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it busybox -- env</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po busybox</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Create environment variables for pages application with key=<code>PAGE_CONTENT</code> and value=<code>Hello from pages environment</code>
Verify the environment variables are set properly</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/9.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: dellcloud/pages:1.0</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">env</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: PAGE_CONTENT</span></span>
          <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Hello from pages environment</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/9.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it pages -- env</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po pages</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_probes_and_observability">Probes and Observability:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a pod that runs a web server. Configure readiness probe within the pod so that Kubernetes sends the
first request after 5 seconds and check if port 80 is accessible. Hint: use nginx image</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/10.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: nginx</span></span>
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
    <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
    <span style="color:#606">readinessProbe</span>:
      <span style="color:#606">tcpSocket</span>:
        <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">80</span></span>
      <span style="color:#606">initialDelaySeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/10.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl get po nginx -w</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl describe po nginx | grep -i readiness</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po nginx</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>In the previous scenario add a liveness probe of type exec command to check if index.html exists whose exit code determines the success of the probe every 10 seconds.</p>
<details open="">
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/11.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: nginx</span></span>
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">nginx</span></span>
    <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
    <span style="color:#606">readinessProbe</span>:
      <span style="color:#606">tcpSocket</span>:
        <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">80</span></span>
      <span style="color:#606">initialDelaySeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5</span></span>
    <span style="color:#606">livenessProbe</span>:
      <span style="color:#606">exec</span>:
        <span style="color:#606">command</span>:
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">cat</span></span>
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/usr/share/nginx/html/index.html</span></span>
      <span style="color:#606">periodSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">10</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/11.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl get po nginx -w</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl describe po nginx | grep -i ness</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po nginx</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Configure liveness and readiness probe for pages to check if the application is accessible at port 8080</p>
<details>
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/12.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: dellcloud/pages:1.0</span></span>
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pages</span></span>
    <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
    <span style="color:#606">readinessProbe</span>:
      <span style="color:#606">tcpSocket</span>:
        <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8080</span></span>
      <span style="color:#606">initialDelaySeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5</span></span>
    <span style="color:#606">livenessProbe</span>:
      <span style="color:#606">httpGet</span>:
        <span style="color:#606">path</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/</span></span>
        <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8080</span></span>
      <span style="color:#606">periodSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">10</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/12.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl get po pages -w</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl describe po pages | grep -i ness</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po pages</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_volumes">Volumes</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the directory <code>volumes</code> inside <code>competencies</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">mkdir ~/workspace/kubernetes-manifests/competencies/volumes</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</li>
<li>
<p>Mount a directory <code>/var/output</code> to the container which writes the current date to a file called <code>log.txt</code> inside the mounted directory <code>/var/output</code> for every <code>5 seconds</code>. The directory should reside inside the pod and should cease to exist once the pod terminates.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">HINT</dt>
<dd>
<p>Use <code>EmptyDir</code> type of volume</p>
</dd>
</dl>
</div>
<details>
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/volumes/1.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox-1</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-volume</span></span>
      <span style="color:#606">emptyDir</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox-1</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","while true; do date &gt; /var/output/log.txt; sleep 5;done"]</span></span>
      <span style="color:#606">volumeMounts</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-volume</span></span>
          <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/var/output</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/volumes/1.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl get po -w</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it busybox-1 -- cat /var/output/log.txt</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
<li>
<p>Mount a directory <code>/var/output</code> to the container which writes the current date to a file called <code>log.txt</code> inside the mounted directory <code>/var/output</code> for every <code>5 seconds</code>. The directory should reside external to the pod and should exist even if the pod terminates or restarts.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">HINT</dt>
<dd>
<p>Use <code>HostPath</code> type of volume</p>
</dd>
</dl>
</div>
<details>
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/volumes/2.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox-2</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-volume</span></span>
      <span style="color:#606">hostPath</span>:
        <span style="color:#606">path</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/var/output</span></span>
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: busybox</span></span>
      <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox-2</span></span>
      <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
      <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c","while true; do date &gt;&gt; /var/output/log.txt; sleep 5;done"]</span></span>
      <span style="color:#606">volumeMounts</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-volume</span></span>
          <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/var/output</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/volumes/2.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl get po -w</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it busybox-2 -- cat /var/output/log.txt
kubectl delete po busybox-1
kubectl delete po busybox-2</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="paragraph">
<p>Check the content of <code>log.txt</code>. If working in minikube you can use <code>minikube ssh</code> to connect into the node.
If working in production cluster on eks, ssh might be disabled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">cat /var/output/log.txt</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_securitycontext">SecurityContext</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a pod with a container that writes the current date to a file in a mounted volume at /etc/kal-directory/date-file.txt every five seconds. The created file should have the user ID 45 and the group ID 231 which will be useful for auditing and tracking files system updates. Use alpine image.</p>
<details>
<summary class="title">Click to see solution</summary>
<div class="content">
<div class="paragraph">
<p><code>~/workspace/kubernetes-manifests/competencies/pods/13.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">run</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alpine</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alpine</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">securityContext</span>:
    <span style="color:#606">runAsUser</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">45</span></span>
    <span style="color:#606">runAsGroup</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">231</span></span>
  <span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-date-vol</span></span>
      <span style="color:#606">emptyDir</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
  <span style="color:#606">containers</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: alpine</span></span>
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alpine</span></span>
    <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">IfNotPresent</span></span>
    <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["/bin/sh"]</span></span>
    <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">["-c", "while true; do date &gt;&gt; /etc/kal-directory/date-file.txt; sleep 5; done"]</span></span>
    <span style="color:#606">volumeMounts</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: log-date-vol</span></span>
        <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/etc/kal-directory</span></span></code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl apply -f ~/workspace/kubernetes-manifests/competencies/pods/13.yaml</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it alpine -- ps</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl exec -it alpine -- cat /etc/kal-directory/date-file.txt</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell script">kubectl delete po alpine</code><button class="copy-button" style="background: none; border: none; float: right; text-decoration-color: black;"> <img src="./Pods_files/clipboard.svg" width="25" height="30"></button></pre>
</div>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
</div>
</div>
<script src="./Pods_files/jquery-3.5.1.min.js"></script>
<script src="./Pods_files/copy.js"></script>

</body></html>